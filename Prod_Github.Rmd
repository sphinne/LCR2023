---
title: "Productivity_Study"
output:
  html_document
date: "2023-07-03"
editor_options: 
  markdown: 
    wrap: 72
---

\`\`\`{r setup, include=FALSE} knitr::opts_chunk\$set(echo = TRUE)
library(tidyr) library(ggplot2) library(rsconnect) library(dplyr)
library (plotly)
library(rsconnect)

# input data

data <- data.frame( City.Region = c("Cambridgeshire and Peterborough
Combined Authority", "Greater Brighton City Region", "Greater London
Authority"), "X2004" = c(38.19, 33.28, 48.20), "X2005" = c(36.93, 32.92,
49.09), "X2006" = c(36.22, 35.03, 50.62), "X2007" = c(36.94, 35.49,
52.54), "X2008" = c(36.95, 35.49, 51.63), "X2009" = c(35.65, 36.52,
50.26), "X2010" = c(36.79, 36.14, 52.29), "X2011" = c(38.43, 36.83,
52.10), "X2012" = c(38.87, 35.52, 51.37), "X2013" = c(36.75, 36.07,
51.25), "X2014" = c(37.68, 36.33, 52.01), "X2015" = c(36.93, 38.58,
53.21), "X2016" = c(37.27, 36.92, 53.45), "X2017" = c(37.95, 40.49,
53.24), "X2018" = c(37.89, 38.26, 53.58), "X2019" = c(37.57, 39.09,
53.73), "X2020" = c(38.93, 41.07, 54.01), "X2021" = c(40.32, 40.00,
54.29) )

# additional data

additional_data <- data.frame( City.Region = c("Greater Manchester
Combined Authority", "Liverpool City Region Combined Authority", "North
East Combined Authority", "North of Tyne Combined Authority", "Scottish
Island Councils", "South Yorkshire Mayoral Combined Authority", "Tees
Valley Combined Authority", "West Midlands Combined Authority", "West
Yorkshire Combined Authority", "West of England Combined Authority"),
"X2004" = c(32.50476884, 34.11158054, 32.43106188, 32.38683771,
32.71114832, 29.79235276, 33.02071755, 32.43106188, 32.12149265,
35.4383058), "X2005" = c(32.95513461, 33.80013806, 33.28454274,
31.78072304, 31.29377189, 29.56079871, 33.64259505, 32.21038581,
32.94081252, 34.96022755), "X2006" = c(33.92402244, 35.0654955,
33.07487785, 31.83596197, 36.24872976, 30.6527277, 33.52033075,
32.07260882, 33.53425115, 35.03765469), "X2007" = c(35.10319905,
35.21213062, 33.25136233, 31.84886834, 32.84286893, 32.10758082,
33.67347217, 32.06673148, 34.64023987, 36.4648437), "X2008" =
c(34.68334058, 34.78836205, 33.51497672, 30.96820606, 38.39847509,
31.5064411, 33.50184903, 33.00299705, 34.00070102, 37.51892027), "X2009"
= c(34.39669402, 36.06146328, 32.47580642, 30.45247148, 34.92173664,
30.96470817, 33.82042774, 32.77034252, 33.02646087, 37.09874259),
"X2010" = c(34.82726317, 36.53986987, 34.20101146, 31.4403917,
35.82415363, 31.97717888, 33.76646946, 33.70256623, 33.40861134,
38.64867663), "X2011" = c(34.71621046, 36.1822026, 33.99585225,
33.01009892, 38.81087817, 31.07650583, 34.41290174, 33.8062843,
33.7051814, 37.39543748), "X2012" = c(35.05992991, 34.2741684,
34.32405802, 33.70043778, 39.4502164, 31.77968744, 34.24922359,
33.68796538, 33.31379323, 38.4274792), "X2013" = c(35.07362163,
35.18353201, 33.4982396, 32.66780566, 36.55130555, 32.66780566,
34.06000374, 33.04638584, 32.74107925, 37.18634327), "X2014" =
c(34.31600427, 34.49712323, 33.60360306, 32.40821797, 37.52784704,
31.16453449, 34.83521194, 34.13488532, 33.41040951, 38.4455164), "X2015"
= c(35.8350916, 35.60783301, 33.4428959, 33.68211547, 33.69407645,
31.98365652, 36.22980389, 33.90937406, 34.31604733, 39.54299493),
"X2016" = c(35.32143328, 35.35671942, 33.78060485, 34.02760788,
37.5091744, 31.67519807, 36.215349, 35.70958089, 33.43950543,
40.59083125), "X2017" = c(36.01418391, 34.68588655, 33.68100073,
34.38557585, 32.44510667, 32.22564884, 35.00929808, 36.26829296,
34.27007173, 40.46109244), "X2018" = c(35.78831822, 35.15329103,
33.41830602, 33.13481174, 36.25324884, 31.38848696, 34.82443766,
35.9924341, 34.52960361, 39.70053932), "X2019" = c(35.60125704,
33.81342099, 35.24591074, 34.30202214, 38.07757654, 32.28099008,
34.96829645, 35.42358389, 34.435277, 40.05419031), "X2020" =
c(36.9975668, 35.49893118, 34.10436748, 35.30119454, 32.86591166,
31.36727604, 34.61431988, 35.89440447, 35.20752981, 38.94371166),
"X2021" = c(35.81125289, 35.82178871, 32.65050683, 35.06320965,
38.46627958, 32.02889343, 33.37747842, 36.48554538, 34.91570817,
39.73057801) )

# merge the original data with the additional data

full_data \<- rbind(data, additional_data)

# transform data to long format

full_data_long \<- pivot_longer(full_data, cols = starts_with("X"),
names_to = "Year", values_to = "Value")

# replace the 'X' in the year

full_data_long$Year <- gsub("X", "", full_data_long$Year)

# convert the Year column to numeric

full_data_long$Year <- as.numeric(full_data_long$Year)

# Plot

ggplot(full_data_long, aes(x = Year, y = Value, group = City.Region)) +
geom_line(aes(color = City.Region == "Liverpool City Region Combined
Authority"), size = 2) + scale_color_manual(values = c(FALSE = "grey",
TRUE = "pink"), guide = "none") + labs(title = "City Region Data", x =
"Year", y = "Value") + theme_minimal() + theme(legend.position = "none")
